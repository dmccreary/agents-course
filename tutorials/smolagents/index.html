
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Resources for building intelligent agents using knowledge graphs and local GPUs">
      
      
        <meta name="author" content="Dan McCreary">
      
      
        <link rel="canonical" href="https://dmccreary.github.io/agents-course/tutorials/smolagents/">
      
      
        <link rel="prev" href="../ollama/">
      
      
        <link rel="next" href="../smolagents-deepseek-ollama/">
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>SmolAgents - Building Intelligent Agents</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="SmolAgents - Building Intelligent Agents" >
      
        <meta  property="og:description"  content="Resources for building intelligent agents using knowledge graphs and local GPUs" >
      
        <meta  property="og:image"  content="https://dmccreary.github.io/agents-course/assets/images/social/tutorials/smolagents.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://dmccreary.github.io/agents-course/tutorials/smolagents/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="SmolAgents - Building Intelligent Agents" >
      
        <meta  name="twitter:description"  content="Resources for building intelligent agents using knowledge graphs and local GPUs" >
      
        <meta  name="twitter:image"  content="https://dmccreary.github.io/agents-course/assets/images/social/tutorials/smolagents.png" >
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorial-getting-started-with-huggingfaces-smolagents" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Building Intelligent Agents" class="md-header__button md-logo" aria-label="Building Intelligent Agents" data-md-component="logo">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Building Intelligent Agents
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SmolAgents
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/dmccreary/agents-course" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub Repo
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Building Intelligent Agents" class="md-nav__button md-logo" aria-label="Building Intelligent Agents" data-md-component="logo">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    Building Intelligent Agents
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dmccreary/agents-course" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub Repo
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course-description/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Course Description
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../getting-started/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../concepts/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ollama/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ollama
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    SmolAgents
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    SmolAgents
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-smolagents" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding SmoLAgents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-your-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Your Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-ollama-with-deepseek-r1" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up Ollama with DeepSeek-R1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-your-first-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Your First Agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-a-code-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Building a Code Agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-data-analysis-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Data Analysis Agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connection-to-ollama-fails" class="md-nav__link">
    <span class="md-ellipsis">
      Connection to Ollama fails:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out-of-memory-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Out of Memory errors:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Import errors:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-creating-a-react-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced: Creating a ReAct Agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agent-integration-with-knowledge-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      Agent Integration with Knowledge Graphs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smolagents-deepseek-ollama/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SmolAgents Local Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pydanticai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PydanticAI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../prompts/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Prompts
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../sims/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    MicroSims
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-we-built-this-site/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How We Built This Site
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../feedback/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feedback
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    References
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-smolagents" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding SmoLAgents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-your-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Your Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-ollama-with-deepseek-r1" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up Ollama with DeepSeek-R1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-your-first-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Your First Agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-a-code-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Building a Code Agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-data-analysis-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Data Analysis Agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connection-to-ollama-fails" class="md-nav__link">
    <span class="md-ellipsis">
      Connection to Ollama fails:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out-of-memory-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Out of Memory errors:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Import errors:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-creating-a-react-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced: Creating a ReAct Agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agent-integration-with-knowledge-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      Agent Integration with Knowledge Graphs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/dmccreary/agents-course/blob/master/docs/tutorials/smolagents.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="tutorial-getting-started-with-huggingfaces-smolagents">Tutorial: Getting Started with HuggingFace's SmoLAgents</h1>
<p>This tutorial will guide you through setting up and using HuggingFace's SmoLAgents framework with a local LLM deployment using Ollama and DeepSeek-R1. SmoLAgents is a lightweight framework designed for efficient creation and deployment of language model-powered agents.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#understanding-smolagents">Understanding SmoLAgents</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#testing-your-installation">Testing Your Installation</a></li>
<li><a href="#setting-up-ollama-with-deepseek-r1">Setting Up Ollama with DeepSeek-R1</a></li>
<li><a href="#creating-your-first-agent">Creating Your First Agent</a></li>
<li><a href="#building-a-code-agent">Building a Code Agent</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#next-steps">Next Steps</a></li>
</ol>
<h2 id="understanding-smolagents">Understanding SmoLAgents</h2>
<p>SmoLAgents is a framework released by HuggingFace designed to create small, efficient agents. Unlike more complex frameworks like LangChain, SmoLAgents focuses on simplicity and flexible agency levels, from basic decision support to advanced code generation capabilities.</p>
<p>A key feature of SmoLAgents is its support for different agent types, including specialized Code Agents that can generate and execute Python code directly.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Before starting, ensure you have:</p>
<ul>
<li>Python 3.8+ installed</li>
<li>A GPU with at least 12GB VRAM (recommended for running DeepSeek-R1)</li>
<li>Basic understanding of Python programming</li>
<li>Git installed (for repository access)</li>
</ul>
<h2 id="installation">Installation</h2>
<p>Let's install SmoLAgents and its dependencies:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Create a virtual environment (recommended)</span>
python<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>smolagents-env
<span class="nb">source</span><span class="w"> </span>smolagents-env/bin/activate<span class="w">  </span><span class="c1"># On Windows: smolagents-env\Scripts\activate</span>

<span class="c1"># Install SmoLAgents</span>
pip<span class="w"> </span>install<span class="w"> </span>smolagents

<span class="c1"># Install additional dependencies</span>
pip<span class="w"> </span>install<span class="w"> </span>ollama<span class="w">  </span><span class="c1"># Python client for Ollama</span>
</code></pre></div></td></tr></table></div>
<h2 id="testing-your-installation">Testing Your Installation</h2>
<p>Create a simple test script to verify that SmoLAgents is correctly installed:</p>
<p>Run the test script:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python<span class="w"> </span>test_smolagents.py
</code></pre></div></td></tr></table></div>
<p>You should see output similar to:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>SmoLAgents version: 1.9.2
Successfully created tool and model!
Available agent types:
[&#39;Agent&#39;, &#39;CodeAgent&#39;, &#39;JSONAgent&#39;, &#39;ReActAgent&#39;, &#39;SimpleAgent&#39;]
SmoLAgents installation test complete!
</code></pre></div></td></tr></table></div></p>
<p>This confirms that SmoLAgents is installed correctly and shows the available agent types, including the powerful CodeAgent.</p>
<h2 id="setting-up-ollama-with-deepseek-r1">Setting Up Ollama with DeepSeek-R1</h2>
<p>To use a local LLM with SmoLAgents, we'll set up Ollama with the DeepSeek-R1 model:</p>
<ol>
<li>
<p><strong>Install Ollama</strong>: Download and install from <a href="https://ollama.ai/">ollama.ai</a></p>
</li>
<li>
<p><strong>Pull the DeepSeek-R1 model</strong>:
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>ollama<span class="w"> </span>pull<span class="w"> </span>deepseek-r1:7b
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p><strong>Verify the model is available</strong>:
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>ollama<span class="w"> </span>list
</code></pre></div></td></tr></table></div></p>
</li>
</ol>
<p>You should see output similar to:
   <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>NAME                    ID          SIZE    MODIFIED     
deepseek-r1:latest      0a8c26691023 4.7 GB  3 weeks ago     
deepseek-r1:7b          0a8c26691023 4.7 GB  3 weeks ago
</code></pre></div></td></tr></table></div></p>
<h2 id="creating-your-first-agent">Creating Your First Agent</h2>
<p>Now, let's create a simple agent that uses the DeepSeek-R1 model via Ollama:</p>
<p>Run the simple agent:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python<span class="w"> </span>simple_agent.py
</code></pre></div></td></tr></table></div>
<p>This agent demonstrates:
- Using the <code>@tool</code> decorator to create a custom tool
- Connecting to Ollama to use DeepSeek-R1
- Creating a basic Agent with tools
- Running the agent with a user query</p>
<h2 id="building-a-code-agent">Building a Code Agent</h2>
<p>Now, let's create a more advanced Code Agent that can write and execute Python code:</p>
<p>Run the code agent:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python<span class="w"> </span>code_agent.py
</code></pre></div></td></tr></table></div>
<p>This code agent demonstrates:
- Using the CodeAgent class to create an agent that can generate and execute Python code
- Setting safety constraints with allowed modules
- Handling more complex tasks requiring data generation and visualization</p>
<h2 id="creating-a-data-analysis-agent">Creating a Data Analysis Agent</h2>
<p>Let's create a more practical example - an agent that can analyze CSV data:</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>If you encounter issues:</p>
<h3 id="connection-to-ollama-fails">Connection to Ollama fails:</h3>
<ul>
<li>Ensure Ollama is running: <code>ollama serve</code></li>
<li>Verify the model is downloaded: <code>ollama list</code></li>
<li>Check the API endpoint URL: default is <code>http://localhost:11434/v1</code></li>
</ul>
<h3 id="out-of-memory-errors">Out of Memory errors:</h3>
<ul>
<li>DeepSeek-R1 7B requires around 12GB of VRAM</li>
<li>Try closing other applications using GPU memory</li>
<li>Consider using a smaller model if necessary</li>
</ul>
<h3 id="import-errors">Import errors:</h3>
<ul>
<li>Ensure all dependencies are installed: <code>pip install -r requirements.txt</code></li>
<li>Check for version conflicts: <code>pip list | grep smolagents</code></li>
</ul>
<h2 id="advanced-creating-a-react-agent">Advanced: Creating a ReAct Agent</h2>
<p>The ReAct (Reasoning-Action) framework combines reasoning traces with actions. Let's create a ReAct agent:</p>
<h2 id="agent-integration-with-knowledge-graphs">Agent Integration with Knowledge Graphs</h2>
<p>Let's create an example that combines SmoLAgents with a simple knowledge graph:</p>
<p>Let me continue with the knowledge graph agent code:</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># knowledge_graph_agent.py - SmoLAgents with a simple knowledge graph</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">smolagents</span> <span class="kn">import</span> <span class="n">CodeAgent</span><span class="p">,</span> <span class="n">FinalAnswerTool</span><span class="p">,</span> <span class="n">tool</span>
<span class="kn">from</span> <span class="nn">smolagents.models</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="c1"># Create a simple knowledge graph for the course concepts</span>
<span class="k">def</span> <span class="nf">create_knowledge_graph</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a simple knowledge graph of course concepts.&quot;&quot;&quot;</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

    <span class="c1"># Add nodes (concepts)</span>
    <span class="n">concepts</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;agent&quot;</span><span class="p">:</span> <span class="s2">&quot;An autonomous computational entity that performs tasks with independence&quot;</span><span class="p">,</span>
        <span class="s2">&quot;llm&quot;</span><span class="p">:</span> <span class="s2">&quot;Large Language Model - a deep learning model trained on text data&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tool&quot;</span><span class="p">:</span> <span class="s2">&quot;An atomic function used by an agent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;code_agent&quot;</span><span class="p">:</span> <span class="s2">&quot;A specialized agent that can write and execute code&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ollama&quot;</span><span class="p">:</span> <span class="s2">&quot;Software framework for local LLM deployment&quot;</span><span class="p">,</span>
        <span class="s2">&quot;deepseek_r1&quot;</span><span class="p">:</span> <span class="s2">&quot;A large language model developed in China&quot;</span><span class="p">,</span>
        <span class="s2">&quot;react&quot;</span><span class="p">:</span> <span class="s2">&quot;Framework that interleaves reasoning and action&quot;</span><span class="p">,</span>
        <span class="s2">&quot;knowledge_graph&quot;</span><span class="p">:</span> <span class="s2">&quot;A structured representation of knowledge with entities and relationships&quot;</span><span class="p">,</span>
        <span class="s2">&quot;agency_level&quot;</span><span class="p">:</span> <span class="s2">&quot;The degree of autonomy granted to an intelligent agent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tool_catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;A list of tools available for an agent to use&quot;</span>
    <span class="p">}</span>

    <span class="c1"># Add each concept as a node with its definition</span>
    <span class="k">for</span> <span class="n">concept</span><span class="p">,</span> <span class="n">definition</span> <span class="ow">in</span> <span class="n">concepts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">concept</span><span class="p">,</span> <span class="n">definition</span><span class="o">=</span><span class="n">definition</span><span class="p">)</span>

    <span class="c1"># Add edges (relationships between concepts)</span>
    <span class="n">relationships</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;agent&quot;</span><span class="p">,</span> <span class="s2">&quot;code_agent&quot;</span><span class="p">,</span> <span class="s2">&quot;is a type of&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;agent&quot;</span><span class="p">,</span> <span class="s2">&quot;tool&quot;</span><span class="p">,</span> <span class="s2">&quot;uses&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;llm&quot;</span><span class="p">,</span> <span class="s2">&quot;agent&quot;</span><span class="p">,</span> <span class="s2">&quot;powers&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;tool&quot;</span><span class="p">,</span> <span class="s2">&quot;tool_catalog&quot;</span><span class="p">,</span> <span class="s2">&quot;belongs to&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;ollama&quot;</span><span class="p">,</span> <span class="s2">&quot;deepseek_r1&quot;</span><span class="p">,</span> <span class="s2">&quot;can run&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;agent&quot;</span><span class="p">,</span> <span class="s2">&quot;react&quot;</span><span class="p">,</span> <span class="s2">&quot;can implement&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;agent&quot;</span><span class="p">,</span> <span class="s2">&quot;knowledge_graph&quot;</span><span class="p">,</span> <span class="s2">&quot;can use&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;agency_level&quot;</span><span class="p">,</span> <span class="s2">&quot;agent&quot;</span><span class="p">,</span> <span class="s2">&quot;classifies&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;code_agent&quot;</span><span class="p">,</span> <span class="s2">&quot;agency_level&quot;</span><span class="p">,</span> <span class="s2">&quot;has highest&quot;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="c1"># Add each relationship as an edge</span>
    <span class="k">for</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">relation</span> <span class="ow">in</span> <span class="n">relationships</span><span class="p">:</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">relation</span><span class="o">=</span><span class="n">relation</span><span class="p">)</span>

    <span class="c1"># Save the graph to a JSON file</span>
    <span class="n">graph_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">node</span><span class="p">,</span>
            <span class="s2">&quot;definition&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;definition&quot;</span><span class="p">]</span>
        <span class="p">}</span> <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)],</span>
        <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span>
            <span class="s2">&quot;relation&quot;</span><span class="p">:</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">][</span><span class="s2">&quot;relation&quot;</span><span class="p">]</span>
        <span class="p">}</span> <span class="k">for</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()]</span>
    <span class="p">}</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;course_knowledge_graph.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">graph_data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">G</span><span class="p">,</span> <span class="s2">&quot;course_knowledge_graph.json&quot;</span>

<span class="c1"># Create knowledge graph tools</span>
<span class="nd">@tool</span>
<span class="k">def</span> <span class="nf">query_concept</span><span class="p">(</span><span class="n">concept</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the definition of a concept from the knowledge graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        concept (str): The concept to query</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Information about the concept including definition and relationships</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;course_knowledge_graph.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">graph_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="c1"># Find the concept in nodes</span>
        <span class="n">concept</span> <span class="o">=</span> <span class="n">concept</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">node</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph_data</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">node</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">concept</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Concept &#39;</span><span class="si">{</span><span class="n">concept</span><span class="si">}</span><span class="s2">&#39; not found in knowledge graph&quot;</span><span class="p">}</span>

        <span class="c1"># Find relationships</span>
        <span class="n">relationships</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">graph_data</span><span class="p">[</span><span class="s2">&quot;edges&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">concept</span><span class="p">:</span>
                <span class="n">relationships</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s2">&quot;relation&quot;</span><span class="p">:</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;relation&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>
                <span class="p">})</span>
            <span class="k">elif</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">concept</span><span class="p">:</span>
                <span class="n">relationships</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s2">&quot;relation&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;is </span><span class="si">{</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;relation&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> by&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span>
                <span class="p">})</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;concept&quot;</span><span class="p">:</span> <span class="n">concept</span><span class="p">,</span>
            <span class="s2">&quot;definition&quot;</span><span class="p">:</span> <span class="n">node</span><span class="p">[</span><span class="s2">&quot;definition&quot;</span><span class="p">],</span>
            <span class="s2">&quot;relationships&quot;</span><span class="p">:</span> <span class="n">relationships</span>
        <span class="p">}</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error querying concept: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>

<span class="nd">@tool</span>
<span class="k">def</span> <span class="nf">list_all_concepts</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List all concepts in the knowledge graph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: All concepts in the knowledge graph</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;course_knowledge_graph.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">graph_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph_data</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">]]</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error listing concepts: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>

<span class="nd">@tool</span>
<span class="k">def</span> <span class="nf">visualize_knowledge_graph</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a visualization of the knowledge graph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Path to the saved visualization image</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;course_knowledge_graph.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">graph_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="c1"># Create a new directed graph</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

        <span class="c1"># Add nodes</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph_data</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">]:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>

        <span class="c1"># Add edges</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">graph_data</span><span class="p">[</span><span class="s2">&quot;edges&quot;</span><span class="p">]:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">],</span> <span class="n">relation</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="s2">&quot;relation&quot;</span><span class="p">])</span>

        <span class="c1"># Create visualization</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">,</span> 
                <span class="n">node_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> 
                <span class="n">arrowsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

        <span class="c1"># Add edge labels</span>
        <span class="n">edge_labels</span> <span class="o">=</span> <span class="p">{(</span><span class="n">edge</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]):</span> <span class="n">edge</span><span class="p">[</span><span class="s2">&quot;relation&quot;</span><span class="p">]</span> 
                      <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">graph_data</span><span class="p">[</span><span class="s2">&quot;edges&quot;</span><span class="p">]}</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

        <span class="c1"># Save the visualization</span>
        <span class="n">output_path</span> <span class="o">=</span> <span class="s2">&quot;knowledge_graph_visualization.png&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;visualization_path&quot;</span><span class="p">:</span> <span class="n">output_path</span><span class="p">}</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error visualizing graph: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Create the knowledge graph</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">kg_path</span> <span class="o">=</span> <span class="n">create_knowledge_graph</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Knowledge graph created: </span><span class="si">{</span><span class="n">kg_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if networkx is installed</span>
        <span class="kn">import</span> <span class="nn">networkx</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NetworkX is required for this example.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please install it with: pip install networkx matplotlib&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Create a model using the Ollama endpoint for DeepSeek-R1</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
        <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;http://localhost:11434/v1&quot;</span><span class="p">,</span>
        <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;deepseek-r1&quot;</span><span class="p">,</span>
        <span class="n">api_type</span><span class="o">=</span><span class="s2">&quot;ollama&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Create a Code Agent with knowledge graph tools</span>
    <span class="n">allowed_modules</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="s2">&quot;networkx&quot;</span><span class="p">,</span> <span class="s2">&quot;matplotlib.pyplot&quot;</span><span class="p">,</span> <span class="s2">&quot;os&quot;</span><span class="p">]</span>

    <span class="n">kg_agent</span> <span class="o">=</span> <span class="n">CodeAgent</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">query_concept</span><span class="p">,</span> <span class="n">list_all_concepts</span><span class="p">,</span> <span class="n">visualize_knowledge_graph</span><span class="p">,</span> <span class="n">FinalAnswerTool</span><span class="p">()],</span>
        <span class="n">allowed_modules</span><span class="o">=</span><span class="n">allowed_modules</span>
    <span class="p">)</span>

    <span class="c1"># Example query about course concepts</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Explain what a code agent is and how it relates to other concepts in the course.</span>
<span class="s2">    Also, visualize the knowledge graph to help me understand the relationships.</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Agent response:&quot;</span><span class="p">)</span>

    <span class="c1"># Run the agent and capture the response</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">kg_agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">system_message</span><span class="p">},</span>
            <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">}</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># Print the response</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="c1"># Example query about multiple concepts</span>
    <span class="n">comparison_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Compare the concepts of &#39;agent&#39;, &#39;tool&#39;, and &#39;llm&#39;. How do they relate to each other</span>
<span class="s2">    in the context of this course?</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Query: </span><span class="si">{</span><span class="n">comparison_query</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Agent response:&quot;</span><span class="p">)</span>

    <span class="c1"># Run the agent with the comparison query</span>
    <span class="n">comparison_response</span> <span class="o">=</span> <span class="n">kg_agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">system_message</span><span class="p">},</span>
            <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">comparison_query</span><span class="p">}</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># Print the response</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">comparison_response</span><span class="p">)</span>

    <span class="c1"># Define a system message for the knowledge graph agent</span>
    <span class="n">system_message</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    You are a knowledge graph assistant for a course on intelligent software agents.</span>
<span class="s2">    You can query concepts in the knowledge graph, list all available concepts,</span>
<span class="s2">    and visualize the relationships between concepts.</span>

<span class="s2">    When answering questions:</span>
<span class="s2">    1. Use the knowledge graph tools to retrieve relevant information</span>
<span class="s2">    2. Explain the concepts clearly using the information from the graph</span>
<span class="s2">    3. Highlight relationships between concepts to show their connections</span>
<span class="s2">    4. If requested, create visualizations to help illustrate the relationships</span>
<span class="s2">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
Now let's create a comprehensive requirements.txt file for all our examples:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code># Core requirements
smolagents&gt;=1.9.2
ollama&gt;=0.1.10

# For data analysis and visualization
pandas&gt;=1.3.0
numpy&gt;=1.20.0
matplotlib&gt;=3.4.0
seaborn&gt;=0.11.0

# For knowledge graph example
networkx&gt;=2.6.0

# Optional dependencies
# scikit-learn&gt;=1.0.0  # For machine learning tasks
# requests&gt;=2.25.0     # For API calls
# beautifulsoup4&gt;=4.9.0  # For web scraping
</code></pre></div></td></tr></table></div>
<p>Let's also create a step-by-step installation and setup guide:</p>
<h2 id="next-steps">Next Steps</h2>
<p>Now that you've learned the basics of SmoLAgents and how to integrate it with Ollama and DeepSeek-R1, here are some ideas for expanding your skills:</p>
<ol>
<li>
<p><strong>Create Your Own Tools</strong>: Design custom tools for specific domains like finance, healthcare, or education.</p>
</li>
<li>
<p><strong>Experiment with Different LLMs</strong>: Try other models available in Ollama like Llama2, Mistral, or smaller versions of DeepSeek-R1.</p>
</li>
<li>
<p><strong>Multi-Agent Systems</strong>: Create applications where multiple specialized agents collaborate to solve complex problems.</p>
</li>
<li>
<p><strong>Integration with Real Data Sources</strong>: Connect your agents to databases, APIs, or real-time data streams.</p>
</li>
<li>
<p><strong>Explore Agency Levels</strong>: Implement agents with different levels of autonomy, from simple decision support to fully autonomous code generation.</p>
</li>
<li>
<p><strong>Compare Agent Frameworks</strong>: Try implementing the same functionality with other frameworks like PydanticAI or LangChain to understand the trade-offs.</p>
</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>SmoLAgents provides a lightweight, efficient framework for building AI agents with LLMs. Its unique features, particularly the CodeAgent that can write and execute Python code, make it a powerful tool for developing autonomous systems.</p>
<p>By combining SmoLAgents with local LLM deployment via Ollama and models like DeepSeek-R1, you can create sophisticated agent applications that run entirely on your local machine, providing better privacy, control, and cost-effectiveness compared to cloud-based solutions.</p>
<p>The examples in this tutorial demonstrate the flexibility of the framework - from simple tool-calling to advanced data analysis and knowledge graph integration. As you continue to explore, you'll discover how these building blocks can be combined to create intelligent agents that solve real-world problems.</p>
<p>Remember to follow the setup guide and refer to the provided code examples as you build your own agent applications. Happy building!</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../ollama/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Ollama">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Ollama
              </div>
            </div>
          </a>
        
        
          
          <a href="../smolagents-deepseek-ollama/" class="md-footer__link md-footer__link--next" aria-label="Next: SmolAgents Local Setup">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                SmolAgents Local Setup
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Dan McCreary. Licensed under <a href="license/">CC BY-NC-SA 4.0</a> for non-commercial use.
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.expand", "navigation.path", "navigation.prune", "navigation.indexes", "toc.follow", "navigation.top", "navigation.footer", "content.action.edit"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../js/extra.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>